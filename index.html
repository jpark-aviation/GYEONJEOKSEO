<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Í≤¨Ï†ÅÏÑú ÏÉùÏÑ± ÌîÑÎ°úÍ∑∏Îû®</title>
    <!-- html2pdf.js CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js" integrity="sha512-GsLlZN/3F2ErC5ifS5QtgpiJtWd43JWSuIgh7mbzZ8zBps+dvLusV+eNQATqgA/HdeKFVgA5v3S/cIrLF7QnIg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Malgun Gothic', -apple-system, BlinkMacSystemFont, sans-serif; 
            background-color: #f5f5f5; 
            padding: 10px; 
            line-height: 1.6;
            -webkit-text-size-adjust: 100%;
        }
        .container { 
            max-width: 1200px; 
            margin: 0 auto; 
            background: white; 
            border-radius: 10px; 
            box-shadow: 0 2px 10px rgba(0,0,0,0.1); 
            padding: 20px; 
        }
        h1 { 
            text-align: center; 
            color: #333; 
            margin-bottom: 30px; 
            font-size: clamp(20px, 4vw, 28px); 
        }
        .section { 
            margin-bottom: 25px; 
            padding: 15px; 
            border: 1px solid #ddd; 
            border-radius: 8px; 
            background: #fafafa; 
        }
        .section-title { 
            font-size: clamp(16px, 3vw, 18px); 
            font-weight: bold; 
            margin-bottom: 15px; 
            color: #444; 
            border-bottom: 2px solid #007bff; 
            padding-bottom: 5px; 
        }
        .form-row { 
            display: flex; 
            flex-wrap: wrap; 
            gap: 15px; 
            margin-bottom: 15px; 
            align-items: center; 
        }
        .form-group { 
            display: flex; 
            flex-direction: column; 
            min-width: 200px; 
            flex: 1; 
        }
        .form-group.inline { 
            flex-direction: row; 
            align-items: center; 
            gap: 10px; 
        }
        label { 
            font-weight: bold; 
            color: #555; 
            margin-bottom: 5px; 
            font-size: 14px; 
        }
        .form-group.inline label { 
            margin-bottom: 0; 
            min-width: 80px; 
        }
        
        /* ÌïÑÏàò Ìï≠Î™© Î≥ÑÌëú Ïä§ÌÉÄÏùº */
        .required {
            color: #dc3545;
            font-weight: bold;
            margin-left: 3px;
        }
        
        input, textarea, select { 
            padding: 12px 15px; 
            border: 2px solid #ccc; 
            border-radius: 6px; 
            font-size: 16px; 
            width: 100%; 
            transition: all 0.3s ease;
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
        }
        
        /* ÎÇ†Ïßú ÏûÖÎ†• ÌïÑÎìú Ïä§ÌÉÄÏùº */
        #date {
            cursor: pointer;
            background-color: #fff;
            position: relative;
        }
        
        #date:focus {
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 8px rgba(0,123,255,0.3);
        }
        
        /* Îã¨Î†• ÏïÑÏù¥ÏΩò Ï∂îÍ∞Ä */
        .date-input-wrapper {
            position: relative;
            display: inline-block;
            width: 100%;
        }
        
        .date-input-wrapper::after {
            content: "üìÖ";
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            pointer-events: none;
            font-size: 16px;
        }
        
        input:focus, textarea:focus, select:focus { 
            outline: none; 
            border-color: #007bff; 
            box-shadow: 0 0 8px rgba(0,123,255,0.3); 
            transform: scale(1.02);
        }
        
        button { 
            background: #007bff; 
            color: white; 
            border: none; 
            padding: 15px 25px; 
            border-radius: 8px; 
            cursor: pointer; 
            font-size: 16px; 
            margin: 8px; 
            transition: all 0.3s ease; 
            min-width: 140px;
            min-height: 48px;
            touch-action: manipulation;
            -webkit-tap-highlight-color: transparent;
        }
        button:hover, button:focus { 
            background: #0056b3; 
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,123,255,0.3);
        }
        button:active {
            transform: translateY(0);
            box-shadow: 0 2px 6px rgba(0,123,255,0.3);
        }
        button.danger { background: #dc3545; }
        button.danger:hover { background: #c82333; }
        button.success { background: #28a745; }
        button.success:hover { background: #218838; }
        button.warning { background: #ffc107; color: #212529; }
        button.warning:hover { background: #e0a800; }
        
        .table-container { 
            overflow-x: auto; 
            margin-top: 15px; 
            border-radius: 8px; 
            border: 1px solid #ddd; 
            -webkit-overflow-scrolling: touch;
        }
        .items-table { 
            width: 100%; 
            border-collapse: collapse; 
            min-width: 700px; 
        }
        .items-table th, .items-table td { 
            border: 1px solid #ddd; 
            padding: 12px 10px; 
            text-align: center; 
            font-size: 14px; 
        }
        .items-table th { 
            background: #f8f9fa; 
            font-weight: bold; 
            position: sticky; 
            top: 0; 
            z-index: 10; 
        }
        .items-table tr:nth-child(even) { background: #f9f9f9; }
        .items-table tr:hover { background: #e9ecef; }
        
        .total-section { 
            text-align: right; 
            margin-top: 20px; 
            font-size: clamp(16px, 3vw, 18px); 
            font-weight: bold; 
            color: #007bff; 
            padding: 15px; 
            background: #f8f9fa; 
            border-radius: 5px; 
        }
        
        /* Î∂ÄÍ∞ÄÏÑ∏ Í≥ÑÏÇ∞ ÏÑπÏÖò Ïä§ÌÉÄÏùº */
        .calculation-section {
            text-align: right;
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 5px;
            border: 2px solid #007bff;
        }
        
        .calculation-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
            font-size: 16px;
        }
        
        .calculation-row.subtotal {
            font-weight: bold;
            color: #333;
            border-bottom: 1px solid #ddd;
            padding-bottom: 8px;
        }
        
        .calculation-row.vat {
            color: #666;
        }
        
        .calculation-row.total {
            font-weight: bold;
            font-size: 18px;
            color: #007bff;
            border-top: 2px solid #007bff;
            padding-top: 8px;
            margin-top: 8px;
        }
        
        .notes-area { 
            width: 100%; 
            min-height: 120px; 
            resize: vertical; 
            font-family: inherit; 
            font-size: 16px; /* Í∏∞ÌÉÄÏÇ¨Ìï≠ Ìè∞Ìä∏ ÌÅ¨Í∏∞ Ï¶ùÍ∞Ä */
        }
        .button-group { 
            display: flex; 
            flex-wrap: wrap; 
            justify-content: center; 
            gap: 10px; 
            margin-top: 30px; 
        }
        .readonly-info { 
            background: #e9ecef; 
            padding: 15px; 
            border-radius: 4px; 
            color: #6c757d; 
            font-size: 14px; 
            line-height: 1.5; 
        }
        
        /* PDF Ï†ÑÏö© Ïä§ÌÉÄÏùº */
        .pdf-content { 
            font-family: 'Malgun Gothic', Arial, sans-serif; 
            max-width: 800px; 
            margin: 0 auto; 
            padding: 40px 20px; 
            background: white; 
            line-height: 1.6; 
            display: none;
        }
        .pdf-title { 
            text-align: center; 
            font-size: 24px; 
            font-weight: bold; 
            margin-bottom: 40px; 
            border-bottom: 3px solid #333; 
            padding-bottom: 15px; 
        }
        
        /* PDF Ï†ïÎ≥¥ ÏÑπÏÖò - ÌÖåÏù¥Î∏î Í∏∞Î∞òÏúºÎ°ú Î≥ÄÍ≤Ω */
        .pdf-info-section { 
            width: 100%;
            margin-bottom: 30px;
        }
        
        .pdf-info-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 30px;
        }
        
        .pdf-info-table td {
            padding: 8px 0;
            vertical-align: top;
            font-size: 14px;
        }
        
        .pdf-info-table .left-column {
            width: 50%;
            padding-right: 20px;
        }
        
        .pdf-info-table .right-column {
            width: 50%;
            text-align: right;
            padding-left: 20px;
        }
        
        .pdf-info-item { 
            margin-bottom: 8px; 
            font-size: 14px; 
        }
        .pdf-info-label { 
            font-weight: bold; 
            display: inline-block; 
            width: 80px; 
        }
        .pdf-section-title { 
            font-size: 16px; 
            font-weight: bold; 
            margin: 30px 0 15px 0; 
            padding: 8px 0; 
            border-bottom: 2px solid #666; 
        }
        .pdf-table { 
            width: 100%; 
            border-collapse: collapse; 
            margin: 20px 0; 
            font-size: 12px; 
        }
        .pdf-table th { 
            background-color: #f0f0f0; 
            border: 1px solid #333; 
            padding: 10px 5px; 
            text-align: center; 
            font-weight: bold; 
        }
        .pdf-table td { 
            border: 1px solid #333; 
            padding: 8px 5px; 
            text-align: center; 
        }
        .pdf-table .text-left { text-align: left; }
        .pdf-table .text-right { text-align: right; }
        .pdf-table .text-center { text-align: center; }
        .pdf-table .pdf-total-row { background-color: #f8f8f8; font-weight: bold; }
        
        /* PDF Î∂ÄÍ∞ÄÏÑ∏ Í≥ÑÏÇ∞ ÌÖåÏù¥Î∏î */
        .pdf-calculation-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            font-size: 12px;
        }
        
        .pdf-calculation-table td {
            border: 1px solid #333;
            padding: 8px 5px;
            text-align: right;
        }
        
        .pdf-calculation-table .label-cell {
            text-align: center;
            font-weight: bold;
            background-color: #f0f0f0;
        }
        
        .pdf-calculation-table .total-row {
            background-color: #f8f8f8;
            font-weight: bold;
        }
        
        .pdf-notes { 
            margin-top: 30px; 
            padding: 15px; 
            background-color: #f9f9f9; 
            border-left: 4px solid #007bff; 
        }
        .pdf-notes-title { font-weight: bold; margin-bottom: 10px; }
        .pdf-notes-content { font-size: 13px; line-height: 1.5; } /* Í∏∞ÌÉÄÏÇ¨Ìï≠ Ìè∞Ìä∏ ÌÅ¨Í∏∞ Ï¶ùÍ∞Ä */
        .pdf-footer { 
            margin-top: 40px; 
            text-align: center; 
            font-size: 12px; 
            color: #666; 
        }
        
        /* Î™®Î∞îÏùº ÏµúÏ†ÅÌôî */
        @media (max-width: 768px) {
            body { padding: 5px; }
            .container { padding: 15px; border-radius: 5px; }
            .section { padding: 12px; margin-bottom: 15px; }
            .form-row { flex-direction: column; gap: 12px; }
            .form-group { min-width: 100%; }
            .form-group.inline { flex-direction: column; align-items: flex-start; }
            .form-group.inline label { min-width: auto; margin-bottom: 5px; }
            .button-group { flex-direction: column; align-items: stretch; }
            button { 
                margin: 6px 0; 
                padding: 18px; 
                font-size: 18px; 
                min-height: 52px;
            }
            .items-table th, .items-table td { padding: 10px 6px; font-size: 13px; }
            .readonly-info { font-size: 13px; padding: 12px; }
            .total-section, .calculation-section { text-align: center; padding: 12px; }
            
            /* Î™®Î∞îÏùº ÌÑ∞Ïπò Í∞úÏÑ† */
            input, textarea { font-size: 16px; padding: 14px; }
            .items-table button { padding: 10px 15px; min-width: 70px; }
            
            .calculation-row {
                font-size: 14px;
            }
            
            .calculation-row.total {
                font-size: 16px;
            }
            
            /* PDF Ï†ïÎ≥¥ ÌÖåÏù¥Î∏î Î™®Î∞îÏùº ÏµúÏ†ÅÌôî */
            .pdf-info-table .left-column,
            .pdf-info-table .right-column {
                width: 100%;
                padding: 0;
                text-align: left;
            }
        }
        
        /* ÌÉúÎ∏îÎ¶ø ÏµúÏ†ÅÌôî */
        @media (min-width: 769px) and (max-width: 1024px) {
            .form-row { gap: 12px; }
            .form-group { min-width: 180px; }
            button { padding: 14px 22px; }
        }
        
        /* ÎØ∏Î¶¨Î≥¥Í∏∞ Ï∞Ω */
        .preview-window { 
            position: fixed; 
            top: 50%; 
            left: 50%; 
            transform: translate(-50%, -50%); 
            width: 90%; 
            height: 80%; 
            max-width: 800px; 
            background: white; 
            border: 2px solid #007bff; 
            border-radius: 10px; 
            z-index: 1000; 
            overflow: auto; 
            padding: 20px; 
            display: none; 
        }
        .preview-overlay { 
            position: fixed; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%; 
            background: rgba(0,0,0,0.5); 
            z-index: 999; 
            display: none; 
        }
        .close-btn { 
            position: absolute; 
            top: 10px; 
            right: 15px; 
            background: #dc3545; 
            color: white; 
            border: none; 
            border-radius: 50%; 
            width: 35px; 
            height: 35px; 
            cursor: pointer; 
            font-size: 18px; 
        }
        
        /* Î°úÎî© Ïä§ÌîºÎÑà */
        .loading-spinner {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 2000;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }
        
        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #007bff;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Í≤¨Ï†ÅÏÑú ÏÉùÏÑ± ÌîÑÎ°úÍ∑∏Îû®</h1>
        
        <!-- Í∏∞Î≥∏ Ï†ïÎ≥¥ ÏÑπÏÖò -->
        <div class="section">
            <div class="section-title">Í∏∞Î≥∏ Ï†ïÎ≥¥</div>
            <div class="form-row">
                <div class="form-group inline">
                    <label>ÏùºÏãú:</label>
                    <div class="date-input-wrapper">
                        <input type="date" id="date" value="">
                    </div>
                </div>
                <div class="form-group inline">
                    <label>Î∞õÎäîÎ∂Ñ:</label>
                    <input type="text" id="clientName" placeholder="Í≥†Í∞ùÎ™ÖÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî">
                </div>
                <div class="form-group inline">
                    <label>Ï†ÑÌôî:</label>
                    <input type="tel" id="clientPhone" placeholder="Í≥†Í∞ù Ï†ÑÌôîÎ≤àÌò∏">
                </div>
            </div>
            <div class="form-row">
                <div class="form-group inline">
                    <label>ÏãúÍ≥µÎÇ¥Ïó≠:</label>
                    <input type="text" id="workDetails" placeholder="ÏãúÍ≥µÎÇ¥Ïó≠ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî">
                </div>
            </div>
            <div class="readonly-info">
                <strong>ÏãúÍ≥µÏûê:</strong> Ï¢ãÏùÄÏù¥ÏõÉ Ïù∏ÌÖåÎ¶¨Ïñ¥<br>
                <strong>Ï†ÑÌôî:</strong> 010-6687-5111<br>
                <strong>Ï£ºÏÜå:</strong> Í≤ΩÍ∏∞ÎèÑ ÌôîÏÑ±Ïãú ÌïúÏã†ÎåÄÍ∏∏ 83
            </div>
        </div>

        <!-- ÌíàÎ™© ÏûÖÎ†• ÏÑπÏÖò -->
        <div class="section">
            <div class="section-title">ÌíàÎ™© ÏûÖÎ†•</div>
            <div class="form-row">
                <div class="form-group">
                    <label>ÌíàÎ™©:</label>
                    <input type="text" id="itemCategory" placeholder="ÌíàÎ™©">
                </div>
                <div class="form-group">
                    <label>ÌíàÎ™Ö<span class="required">*</span>:</label>
                    <input type="text" id="itemName" placeholder="ÌíàÎ™Ö (ÌïÑÏàò)">
                </div>
                <div class="form-group">
                    <label>Í∑úÍ≤©:</label>
                    <input type="text" id="itemSpec" placeholder="Í∑úÍ≤©">
                </div>
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label>ÏàòÎüâ<span class="required">*</span>:</label>
                    <input type="number" id="itemQuantity" placeholder="ÏàòÎüâ (ÌïÑÏàò)" inputmode="numeric">
                </div>
                <div class="form-group">
                    <label>Îã®ÏúÑ:</label>
                    <input type="text" id="itemUnit" placeholder="Îã®ÏúÑ">
                </div>
                <div class="form-group">
                    <label>Îã®Í∞Ä<span class="required">*</span>:</label>
                    <input type="number" id="itemPrice" placeholder="Îã®Í∞Ä (ÌïÑÏàò)" inputmode="numeric">
                </div>
            </div>
            <div class="button-group">
                <button id="addItemBtn" type="button">ÌíàÎ™© Ï∂îÍ∞Ä</button>
            </div>
        </div>

        <!-- ÌíàÎ™© Î™©Î°ù ÏÑπÏÖò -->
        <div class="section">
            <div class="section-title">Í≤¨Ï†Å ÌíàÎ™© Î™©Î°ù</div>
            <div class="table-container">
                <table class="items-table">
                    <thead>
                        <tr>
                            <th>ÌíàÎ™©</th>
                            <th>ÌíàÎ™Ö</th>
                            <th>Í∑úÍ≤©</th>
                            <th>ÏàòÎüâ</th>
                            <th>Îã®ÏúÑ</th>
                            <th>Îã®Í∞Ä</th>
                            <th>Í≥µÍ∏âÍ∞ÄÏï°</th>
                            <th>ÏÇ≠Ï†ú</th>
                        </tr>
                    </thead>
                    <tbody id="itemsTableBody"></tbody>
                </table>
            </div>
            
            <!-- Î∂ÄÍ∞ÄÏÑ∏ Í≥ÑÏÇ∞ ÏÑπÏÖò -->
            <div class="calculation-section">
                <div class="calculation-row subtotal">
                    <span>ÏÜåÍ≥Ñ:</span>
                    <span id="subtotalAmount">0Ïõê</span>
                </div>
                <div class="calculation-row vat">
                    <span>Î∂ÄÍ∞ÄÏÑ∏ / VAT (10%):</span>
                    <span id="vatAmount">0Ïõê</span>
                </div>
                <div class="calculation-row total">
                    <span>Ìï©Í≥Ñ (Î∂ÄÍ∞ÄÏÑ∏ Ìè¨Ìï®):</span>
                    <span id="totalAmount">0Ïõê</span>
                </div>
            </div>
        </div>

        <!-- Í∏∞ÌÉÄÏÇ¨Ìï≠ ÏÑπÏÖò -->
        <div class="section">
            <div class="section-title">Í∏∞ÌÉÄÏÇ¨Ìï≠</div>
            <div class="form-group">
                <textarea id="notes" class="notes-area" placeholder="Í∏∞ÌÉÄÏÇ¨Ìï≠ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî"></textarea>
            </div>
        </div>

        <!-- Î≤ÑÌäº Í∑∏Î£π -->
        <div class="button-group">
            <button id="previewBtn">Í≤¨Ï†ÅÏÑú ÎØ∏Î¶¨Î≥¥Í∏∞</button>
            <button id="printBtn" class="success">Ïù∏ÏáÑÌïòÍ∏∞</button>
            <button id="downloadBtn" class="warning">PDFÎ°ú Ï†ÄÏû•</button>
            <button id="clearBtn" class="danger">Ï¥àÍ∏∞Ìôî</button>
        </div>
    </div>

    <!-- PDF ÏÉùÏÑ±Ïö© Ïà®Í≤®ÏßÑ ÏΩòÌÖêÏ∏† -->
    <div id="pdfContent" class="pdf-content">
        <div class="pdf-title">Í≤¨ Ï†Å ÏÑú</div>
        
        <!-- ÌÖåÏù¥Î∏î Í∏∞Î∞ò Ï†ïÎ≥¥ ÏÑπÏÖòÏúºÎ°ú Î≥ÄÍ≤Ω -->
        <table class="pdf-info-table">
            <tr>
                <td class="left-column">
                    <div class="pdf-info-item"><span class="pdf-info-label">ÏùºÏãú:</span> <span id="pdfDate"></span></div>
                    <div class="pdf-info-item"><span class="pdf-info-label">Î∞õÎäîÎ∂Ñ:</span> <span id="pdfClientName"></span></div>
                    <div class="pdf-info-item"><span class="pdf-info-label">Ï†ÑÌôî:</span> <span id="pdfClientPhone"></span></div>
                    <div class="pdf-info-item"><span class="pdf-info-label">ÏãúÍ≥µÎÇ¥Ïó≠:</span> <span id="pdfWorkDetails"></span></div>
                </td>
                <td class="right-column">
                    <div class="pdf-info-item"><span class="pdf-info-label">ÏãúÍ≥µÏûê:</span> Ï¢ãÏùÄÏù¥ÏõÉ Ïù∏ÌÖåÎ¶¨Ïñ¥</div>
                    <div class="pdf-info-item"><span class="pdf-info-label">Ï†ÑÌôî:</span> 010-6687-5111</div>
                    <div class="pdf-info-item"><span class="pdf-info-label">Ï£ºÏÜå:</span> Í≤ΩÍ∏∞ÎèÑ ÌôîÏÑ±Ïãú ÌïúÏã†ÎåÄÍ∏∏ 83</div>
                </td>
            </tr>
        </table>
        
        <div class="pdf-section-title">ÏÑ∏Î∂ÄÏãúÍ≥µÎÇ¥Ïó≠</div>
        <table class="pdf-table" id="pdfTable">
            <thead>
                <tr>
                    <th style="width: 12%">ÌíàÎ™©</th>
                    <th style="width: 20%">ÌíàÎ™Ö</th>
                    <th style="width: 18%">Í∑úÍ≤©</th>
                    <th style="width: 8%">ÏàòÎüâ</th>
                    <th style="width: 8%">Îã®ÏúÑ</th>
                    <th style="width: 15%">Îã®Í∞Ä</th>
                    <th style="width: 19%">Í≥µÍ∏âÍ∞ÄÏï°</th>
                </tr>
            </thead>
            <tbody id="pdfTableBody"></tbody>
        </table>
        
        <!-- PDF Î∂ÄÍ∞ÄÏÑ∏ Í≥ÑÏÇ∞ ÌÖåÏù¥Î∏î -->
        <table class="pdf-calculation-table">
            <tr>
                <td class="label-cell" style="width: 70%">ÏÜåÍ≥Ñ</td>
                <td class="text-right" style="width: 30%"><span id="pdfSubtotal">0</span></td>
            </tr>
            <tr>
                <td class="label-cell">Î∂ÄÍ∞ÄÏÑ∏ / VAT (10%)</td>
                <td class="text-right"><span id="pdfVat">0</span></td>
            </tr>
            <tr class="total-row">
                <td class="label-cell"><strong>Ìï©Í≥Ñ (Î∂ÄÍ∞ÄÏÑ∏ Ìè¨Ìï®)</strong></td>
                <td class="text-right"><strong id="pdfTotal">0</strong></td>
            </tr>
        </table>
        
        <div style="margin-top: 20px; font-size: 14px;">
            <strong>*Í≥ÑÏïΩÍ∏à Î≥ÑÎèÑ</strong>
        </div>
        <div class="pdf-notes" id="pdfNotesSection" style="display: none;">
            <div class="pdf-notes-title">Í∏∞ÌÉÄÏÇ¨Ìï≠</div>
            <div class="pdf-notes-content" id="pdfNotes"></div>
        </div>
        <div class="pdf-footer">
            Í≤¨Ï†ÅÏÑú Î∞úÌñâÏùº: <span id="pdfIssueDate"></span>
        </div>
    </div>

    <!-- ÎØ∏Î¶¨Î≥¥Í∏∞ Ï∞Ω -->
    <div class="preview-overlay" id="previewOverlay"></div>
    <div class="preview-window" id="previewWindow">
        <button class="close-btn" id="closeBtn">√ó</button>
        <div id="previewContent"></div>
    </div>

    <!-- Î°úÎî© Ïä§ÌîºÎÑà -->
    <div class="loading-spinner" id="loadingSpinner">
        <div class="spinner"></div>
        <div>PDF ÏÉùÏÑ± Ï§ë...</div>
    </div>

    <script>
        // Ï†ÑÏó≠ Î≥ÄÏàò
        let items = [];
        let itemIdCounter = 0;

        // DOM ÏöîÏÜå Ï∞∏Ï°∞
        const elements = {
            date: document.getElementById('date'),
            clientName: document.getElementById('clientName'),
            clientPhone: document.getElementById('clientPhone'),
            workDetails: document.getElementById('workDetails'),
            itemCategory: document.getElementById('itemCategory'),
            itemName: document.getElementById('itemName'),
            itemSpec: document.getElementById('itemSpec'),
            itemQuantity: document.getElementById('itemQuantity'),
            itemUnit: document.getElementById('itemUnit'),
            itemPrice: document.getElementById('itemPrice'),
            itemsTableBody: document.getElementById('itemsTableBody'),
            subtotalAmount: document.getElementById('subtotalAmount'),
            vatAmount: document.getElementById('vatAmount'),
            totalAmount: document.getElementById('totalAmount'),
            notes: document.getElementById('notes'),
            addItemBtn: document.getElementById('addItemBtn'),
            previewBtn: document.getElementById('previewBtn'),
            printBtn: document.getElementById('printBtn'),
            downloadBtn: document.getElementById('downloadBtn'),
            clearBtn: document.getElementById('clearBtn'),
            previewOverlay: document.getElementById('previewOverlay'),
            previewWindow: document.getElementById('previewWindow'),
            previewContent: document.getElementById('previewContent'),
            closeBtn: document.getElementById('closeBtn'),
            loadingSpinner: document.getElementById('loadingSpinner'),
            pdfContent: document.getElementById('pdfContent')
        };

        // Ï¥àÍ∏∞Ìôî Ìï®Ïàò
        function init() {
            setTodayDate();
            setupEventListeners();
        }

        // Ïò§Îäò ÎÇ†Ïßú ÏÑ§Ï†ï (YYYY-MM-DD ÌòïÏãù)
        function setTodayDate() {
            const today = new Date();
            const dateString = today.toISOString().split('T')[0];
            elements.date.value = dateString;
        }

        // ÎÇ†ÏßúÎ•º ÌïúÍµ≠Ïñ¥ ÌòïÏãùÏúºÎ°ú Î≥ÄÌôò (YYYYÎÖÑ MMÏõî DDÏùº)
        function formatDateToKorean(dateString) {
            if (!dateString) return '';
            const date = new Date(dateString);
            return `${date.getFullYear()}ÎÖÑ ${String(date.getMonth() + 1).padStart(2, '0')}Ïõî ${String(date.getDate()).padStart(2, '0')}Ïùº`;
        }

        // Í≥†Í∞ùÎ™ÖÏùÑ "XXX Í≥†Í∞ùÎãò" ÌòïÏãùÏúºÎ°ú Î≥ÄÌôò
        function formatClientName(name) {
            if (!name.trim()) return '';
            return `${name.trim()} Í≥†Í∞ùÎãò`;
        }

        // Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà ÏÑ§Ï†ï
        function setupEventListeners() {
            // ÌíàÎ™© Ï∂îÍ∞Ä Î≤ÑÌäº
            elements.addItemBtn.addEventListener('click', addItem);
            elements.addItemBtn.addEventListener('touchend', function(e) {
                e.preventDefault();
                addItem();
            });

            // Enter ÌÇ§ Ïù¥Î≤§Ìä∏
            const itemInputs = [
                elements.itemCategory, elements.itemName, elements.itemSpec,
                elements.itemQuantity, elements.itemUnit, elements.itemPrice
            ];

            itemInputs.forEach(input => {
                input.addEventListener('keydown', function(e) {
                    if (e.key === 'Enter' || e.keyCode === 13) {
                        e.preventDefault();
                        addItem();
                    }
                });
                input.addEventListener('keyup', function(e) {
                    if (e.key === 'Enter' || e.keyCode === 13) {
                        e.preventDefault();
                        addItem();
                    }
                });
            });

            // Í∏∞ÌÉÄ Î≤ÑÌäº Ïù¥Î≤§Ìä∏
            elements.previewBtn.addEventListener('click', previewQuote);
            elements.printBtn.addEventListener('click', printQuote);
            elements.downloadBtn.addEventListener('click', downloadPDF);
            elements.clearBtn.addEventListener('click', clearAll);

            // ÎØ∏Î¶¨Î≥¥Í∏∞ Ï∞Ω Îã´Í∏∞
            elements.closeBtn.addEventListener('click', closePreview);
            elements.previewOverlay.addEventListener('click', closePreview);
        }

        // ÌíàÎ™© Ï∂îÍ∞Ä Ìï®Ïàò (ÌïÑÏàò Ìï≠Î™© Í≤ÄÏ¶ù Ï∂îÍ∞Ä)
        function addItem() {
            const category = elements.itemCategory.value.trim();
            const name = elements.itemName.value.trim();
            const spec = elements.itemSpec.value.trim();
            const quantity = parseInt(elements.itemQuantity.value) || 0;
            const unit = elements.itemUnit.value.trim();
            const price = parseInt(elements.itemPrice.value) || 0;

            // ÌïÑÏàò Ìï≠Î™© Í≤ÄÏ¶ù
            if (!name) {
                alert('ÌíàÎ™ÖÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî. (ÌïÑÏàò Ìï≠Î™©)');
                elements.itemName.focus();
                return;
            }

            if (quantity <= 0) {
                alert('ÏàòÎüâÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî. (ÌïÑÏàò Ìï≠Î™©)');
                elements.itemQuantity.focus();
                return;
            }

            if (price <= 0) {
                alert('Îã®Í∞ÄÎ•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî. (ÌïÑÏàò Ìï≠Î™©)');
                elements.itemPrice.focus();
                return;
            }

            const total = quantity * price;
            const item = {
                id: itemIdCounter++,
                category: category,
                name: name,
                spec: spec,
                quantity: quantity,
                unit: unit,
                price: price,
                total: total
            };

            items.push(item);
            updateItemsTable();
            clearItemInputs();
            updateCalculations();
        }

        // ÌíàÎ™© ÌÖåÏù¥Î∏î ÏóÖÎç∞Ïù¥Ìä∏
        function updateItemsTable() {
            elements.itemsTableBody.innerHTML = '';
            
            items.forEach(item => {
                const row = elements.itemsTableBody.insertRow();
                row.innerHTML = `
                    <td>${item.category}</td>
                    <td>${item.name}</td>
                    <td>${item.spec}</td>
                    <td>${item.quantity}</td>
                    <td>${item.unit}</td>
                    <td>${item.price.toLocaleString()}</td>
                    <td>${item.total.toLocaleString()}</td>
                    <td><button class="danger" onclick="deleteItem(${item.id})">ÏÇ≠Ï†ú</button></td>
                `;
            });
        }

        // ÌíàÎ™© ÏÇ≠Ï†ú
        function deleteItem(id) {
            if (confirm('Ïù¥ ÌíàÎ™©ÏùÑ ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) {
                items = items.filter(item => item.id !== id);
                updateItemsTable();
                updateCalculations();
            }
        }

        // ÌíàÎ™© ÏûÖÎ†• ÌïÑÎìú Ï¥àÍ∏∞Ìôî
        function clearItemInputs() {
            elements.itemCategory.value = '';
            elements.itemName.value = '';
            elements.itemSpec.value = '';
            elements.itemQuantity.value = '';
            elements.itemUnit.value = '';
            elements.itemPrice.value = '';
            elements.itemName.focus();
        }

        // Î∂ÄÍ∞ÄÏÑ∏ Í≥ÑÏÇ∞ Î∞è ÏóÖÎç∞Ïù¥Ìä∏
        function updateCalculations() {
            const subtotal = items.reduce((sum, item) => sum + item.total, 0);
            const vat = Math.round(subtotal * 0.1); // 10% Î∂ÄÍ∞ÄÏÑ∏
            const total = subtotal + vat;

            elements.subtotalAmount.textContent = `${subtotal.toLocaleString()}Ïõê`;
            elements.vatAmount.textContent = `${vat.toLocaleString()}Ïõê`;
            elements.totalAmount.textContent = `${total.toLocaleString()}Ïõê`;
        }

        // Ï†ÑÏ≤¥ Ï¥àÍ∏∞Ìôî
        function clearAll() {
            if (confirm('Î™®Îì† Îç∞Ïù¥ÌÑ∞Î•º Ï¥àÍ∏∞ÌôîÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) {
                items = [];
                elements.clientName.value = '';
                elements.clientPhone.value = '';
                elements.workDetails.value = '';
                elements.notes.value = '';
                setTodayDate();
                updateItemsTable();
                updateCalculations();
            }
        }

        // Í≤¨Ï†ÅÏÑú ÎØ∏Î¶¨Î≥¥Í∏∞
        function previewQuote() {
            if (items.length === 0) {
                alert('ÎØ∏Î¶¨Î≥¥Í∏∞Ìï† ÌíàÎ™©Ïù¥ ÏóÜÏäµÎãàÎã§.');
                return;
            }
            
            const content = generatePreviewContent();
            elements.previewContent.innerHTML = content;
            elements.previewOverlay.style.display = 'block';
            elements.previewWindow.style.display = 'block';
            document.body.style.overflow = 'hidden';
        }

        // ÎØ∏Î¶¨Î≥¥Í∏∞ Ï∞Ω Îã´Í∏∞
        function closePreview() {
            elements.previewOverlay.style.display = 'none';
            elements.previewWindow.style.display = 'none';
            document.body.style.overflow = 'auto';
        }

        // ÎØ∏Î¶¨Î≥¥Í∏∞ ÎÇ¥Ïö© ÏÉùÏÑ± (ÌÖåÏù¥Î∏î Í∏∞Î∞òÏúºÎ°ú ÏàòÏ†ï)
        function generatePreviewContent() {
            const date = formatDateToKorean(elements.date.value);
            const clientName = formatClientName(elements.clientName.value);
            const clientPhone = elements.clientPhone.value;
            const workDetails = elements.workDetails.value;
            const notes = elements.notes.value;
            
            const subtotal = items.reduce((sum, item) => sum + item.total, 0);
            const vat = Math.round(subtotal * 0.1);
            const total = subtotal + vat;

            let content = `
                <div style="font-family: 'Malgun Gothic', Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; line-height: 1.6;">
                    <div style="text-align: center; font-size: 24px; font-weight: bold; margin-bottom: 40px; border-bottom: 3px solid #333; padding-bottom: 15px;">Í≤¨ Ï†Å ÏÑú</div>
                    
                    <!-- ÌÖåÏù¥Î∏î Í∏∞Î∞ò Ï†ïÎ≥¥ ÏÑπÏÖò -->
                    <table style="width: 100%; border-collapse: collapse; margin-bottom: 30px;">
                        <tr>
                            <td style="width: 50%; padding-right: 20px; vertical-align: top;">
                                <div style="margin-bottom: 8px; font-size: 14px;"><span style="font-weight: bold; display: inline-block; width: 80px;">ÏùºÏãú:</span> ${date}</div>
                                <div style="margin-bottom: 8px; font-size: 14px;"><span style="font-weight: bold; display: inline-block; width: 80px;">Î∞õÎäîÎ∂Ñ:</span> ${clientName}</div>
                                <div style="margin-bottom: 8px; font-size: 14px;"><span style="font-weight: bold; display: inline-block; width: 80px;">Ï†ÑÌôî:</span> ${clientPhone}</div>
                                <div style="margin-bottom: 8px; font-size: 14px;"><span style="font-weight: bold; display: inline-block; width: 80px;">ÏãúÍ≥µÎÇ¥Ïó≠:</span> ${workDetails}</div>
                            </td>
                            <td style="width: 50%; padding-left: 20px; text-align: right; vertical-align: top;">
                                <div style="margin-bottom: 8px; font-size: 14px;"><span style="font-weight: bold; display: inline-block; width: 80px;">ÏãúÍ≥µÏûê:</span> Ï¢ãÏùÄÏù¥ÏõÉ Ïù∏ÌÖåÎ¶¨Ïñ¥</div>
                                <div style="margin-bottom: 8px; font-size: 14px;"><span style="font-weight: bold; display: inline-block; width: 80px;">Ï†ÑÌôî:</span> 010-6687-5111</div>
                                <div style="margin-bottom: 8px; font-size: 14px;"><span style="font-weight: bold; display: inline-block; width: 80px;">Ï£ºÏÜå:</span> Í≤ΩÍ∏∞ÎèÑ ÌôîÏÑ±Ïãú ÌïúÏã†ÎåÄÍ∏∏ 83</div>
                            </td>
                        </tr>
                    </table>
                    
                    <div style="font-size: 16px; font-weight: bold; margin: 30px 0 15px 0; padding: 8px 0; border-bottom: 2px solid #666;">ÏÑ∏Î∂ÄÏãúÍ≥µÎÇ¥Ïó≠</div>
                    <table style="width: 100%; border-collapse: collapse; margin: 20px 0; font-size: 12px;">
                        <thead>
                            <tr>
                                <th style="background-color: #f0f0f0; border: 1px solid #333; padding: 10px 5px; text-align: center; font-weight: bold; width: 12%">ÌíàÎ™©</th>
                                <th style="background-color: #f0f0f0; border: 1px solid #333; padding: 10px 5px; text-align: center; font-weight: bold; width: 20%">ÌíàÎ™Ö</th>
                                <th style="background-color: #f0f0f0; border: 1px solid #333; padding: 10px 5px; text-align: center; font-weight: bold; width: 18%">Í∑úÍ≤©</th>
                                <th style="background-color: #f0f0f0; border: 1px solid #333; padding: 10px 5px; text-align: center; font-weight: bold; width: 8%">ÏàòÎüâ</th>
                                <th style="background-color: #f0f0f0; border: 1px solid #333; padding: 10px 5px; text-align: center; font-weight: bold; width: 8%">Îã®ÏúÑ</th>
                                <th style="background-color: #f0f0f0; border: 1px solid #333; padding: 10px 5px; text-align: center; font-weight: bold; width: 15%">Îã®Í∞Ä</th>
                                <th style="background-color: #f0f0f0; border: 1px solid #333; padding: 10px 5px; text-align: center; font-weight: bold; width: 19%">Í≥µÍ∏âÍ∞ÄÏï°</th>
                            </tr>
                        </thead>
                        <tbody>
            `;

            items.forEach(item => {
                content += `
                    <tr>
                        <td style="border: 1px solid #333; padding: 8px 5px; text-align: left;">${item.category}</td>
                        <td style="border: 1px solid #333; padding: 8px 5px; text-align: left;">${item.name}</td>
                        <td style="border: 1px solid #333; padding: 8px 5px; text-align: left;">${item.spec}</td>
                        <td style="border: 1px solid #333; padding: 8px 5px; text-align: center;">${item.quantity}</td>
                        <td style="border: 1px solid #333; padding: 8px 5px; text-align: center;">${item.unit}</td>
                        <td style="border: 1px solid #333; padding: 8px 5px; text-align: right;">${item.price.toLocaleString()}</td>
                        <td style="border: 1px solid #333; padding: 8px 5px; text-align: right;">${item.total.toLocaleString()}</td>
                    </tr>
                `;
            });

            content += `
                        </tbody>
                    </table>
                    
                    <!-- Î∂ÄÍ∞ÄÏÑ∏ Í≥ÑÏÇ∞ ÌÖåÏù¥Î∏î -->
                    <table style="width: 100%; border-collapse: collapse; margin: 20px 0; font-size: 12px;">
                        <tr>
                            <td style="border: 1px solid #333; padding: 8px 5px; text-align: center; font-weight: bold; background-color: #f0f0f0; width: 70%;">ÏÜåÍ≥Ñ</td>
                            <td style="border: 1px solid #333; padding: 8px 5px; text-align: right; width: 30%;">${subtotal.toLocaleString()}</td>
                        </tr>
                        <tr>
                            <td style="border: 1px solid #333; padding: 8px 5px; text-align: center; font-weight: bold; background-color: #f0f0f0;">Î∂ÄÍ∞ÄÏÑ∏ / VAT (10%)</td>
                            <td style="border: 1px solid #333; padding: 8px 5px; text-align: right;">${vat.toLocaleString()}</td>
                        </tr>
                        <tr style="background-color: #f8f8f8; font-weight: bold;">
                            <td style="border: 1px solid #333; padding: 8px 5px; text-align: center; font-weight: bold; background-color: #f0f0f0;"><strong>Ìï©Í≥Ñ (Î∂ÄÍ∞ÄÏÑ∏ Ìè¨Ìï®)</strong></td>
                            <td style="border: 1px solid #333; padding: 8px 5px; text-align: right;"><strong>${total.toLocaleString()}</strong></td>
                        </tr>
                    </table>
                    
                    <div style="margin-top: 20px; font-size: 14px;">
                        <strong>*Í≥ÑÏïΩÍ∏à Î≥ÑÎèÑ</strong>
                    </div>
            `;

            if (notes.trim()) {
                content += `
                    <div style="margin-top: 30px; padding: 15px; background-color: #f9f9f9; border-left: 4px solid #007bff;">
                        <div style="font-weight: bold; margin-bottom: 10px;">Í∏∞ÌÉÄÏÇ¨Ìï≠</div>
                        <div style="font-size: 13px; line-height: 1.5; white-space: pre-line;">${notes}</div>
                    </div>
                `;
            }

            content += `
                    <div style="margin-top: 40px; text-align: center; font-size: 12px; color: #666;">
                        Í≤¨Ï†ÅÏÑú Î∞úÌñâÏùº: ${new Date().toLocaleDateString('ko-KR')}
                    </div>
                </div>
            `;

            return content;
        }

        // PDFÏö© Îç∞Ïù¥ÌÑ∞ ÏóÖÎç∞Ïù¥Ìä∏
        function updatePDFContent() {
            const date = formatDateToKorean(elements.date.value);
            const clientName = formatClientName(elements.clientName.value);
            const clientPhone = elements.clientPhone.value;
            const workDetails = elements.workDetails.value;
            const notes = elements.notes.value;
            
            const subtotal = items.reduce((sum, item) => sum + item.total, 0);
            const vat = Math.round(subtotal * 0.1);
            const total = subtotal + vat;

            // PDF ÏΩòÌÖêÏ∏† ÏóÖÎç∞Ïù¥Ìä∏
            document.getElementById('pdfDate').textContent = date;
            document.getElementById('pdfClientName').textContent = clientName;
            document.getElementById('pdfClientPhone').textContent = clientPhone;
            document.getElementById('pdfWorkDetails').textContent = workDetails;
            document.getElementById('pdfSubtotal').textContent = subtotal.toLocaleString();
            document.getElementById('pdfVat').textContent = vat.toLocaleString();
            document.getElementById('pdfTotal').textContent = total.toLocaleString();
            document.getElementById('pdfIssueDate').textContent = new Date().toLocaleDateString('ko-KR');

            // ÌÖåÏù¥Î∏î ÏóÖÎç∞Ïù¥Ìä∏
            const pdfTableBody = document.getElementById('pdfTableBody');
            pdfTableBody.innerHTML = '';
            
            items.forEach(item => {
                const row = pdfTableBody.insertRow();
                row.innerHTML = `
                    <td class="text-left">${item.category}</td>
                    <td class="text-left">${item.name}</td>
                    <td class="text-left">${item.spec}</td>
                    <td>${item.quantity}</td>
                    <td>${item.unit}</td>
                    <td class="text-right">${item.price.toLocaleString()}</td>
                    <td class="text-right">${item.total.toLocaleString()}</td>
                `;
            });

            // Í∏∞ÌÉÄÏÇ¨Ìï≠ ÏóÖÎç∞Ïù¥Ìä∏
            const pdfNotesSection = document.getElementById('pdfNotesSection');
            const pdfNotes = document.getElementById('pdfNotes');
            
            if (notes.trim()) {
                pdfNotes.textContent = notes;
                pdfNotesSection.style.display = 'block';
            } else {
                pdfNotesSection.style.display = 'none';
            }
        }

        // html2pdf.jsÎ•º ÏÇ¨Ïö©Ìïú PDF Îã§Ïö¥Î°úÎìú
        function downloadPDF() {
            if (items.length === 0) {
                alert('Ï†ÄÏû•Ìï† ÌíàÎ™©Ïù¥ ÏóÜÏäµÎãàÎã§.');
                return;
            }

            // Î°úÎî© Ïä§ÌîºÎÑà ÌëúÏãú
            elements.loadingSpinner.style.display = 'block';
            
            // PDF ÏΩòÌÖêÏ∏† ÏóÖÎç∞Ïù¥Ìä∏
            updatePDFContent();
            
            // PDF ÏΩòÌÖêÏ∏† ÌëúÏãú
            elements.pdfContent.style.display = 'block';

            // html2pdf ÏòµÏÖò ÏÑ§Ï†ï
            const clientNameForFile = elements.clientName.value || 'Í≥†Í∞ù';
            const dateForFile = formatDateToKorean(elements.date.value).replace(/[ÎÖÑÏõîÏùº]/g, '').replace(/\s/g, '');
            
            const options = {
                margin: [10, 10, 10, 10],
                filename: `Í≤¨Ï†ÅÏÑú_${clientNameForFile}_${dateForFile}.pdf`,
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { 
                    scale: 2,
                    useCORS: true,
                    allowTaint: true,
                    letterRendering: true,
                    scrollX: 0,
                    scrollY: 0
                },
                jsPDF: { 
                    unit: 'mm', 
                    format: 'a4', 
                    orientation: 'portrait' 
                }
            };

            // html2pdf Ïã§Ìñâ
            html2pdf()
                .set(options)
                .from(elements.pdfContent)
                .save()
                .then(() => {
                    // ÏÑ±Í≥µ Ïãú Ï≤òÎ¶¨
                    elements.loadingSpinner.style.display = 'none';
                    elements.pdfContent.style.display = 'none';
                })
                .catch((error) => {
                    // ÏóêÎü¨ Ïãú Ï≤òÎ¶¨
                    console.error('PDF ÏÉùÏÑ± Ïò§Î•ò:', error);
                    elements.loadingSpinner.style.display = 'none';
                    elements.pdfContent.style.display = 'none';
                    alert('PDF ÏÉùÏÑ± Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§. Îã§Ïãú ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî.');
                });
        }

        // Ïù∏ÏáÑÌïòÍ∏∞
        function printQuote() {
            if (items.length === 0) {
                alert('Ïù∏ÏáÑÌï† ÌíàÎ™©Ïù¥ ÏóÜÏäµÎãàÎã§.');
                return;
            }

            const content = generatePreviewContent();
            const printWindow = window.open('', '_blank');
            
            const htmlContent = `
                <!DOCTYPE html>
                <html>
                <head>
                    <title>Í≤¨Ï†ÅÏÑú</title>
                    <meta charset="UTF-8">
                    <meta name="viewport" content="width=device-width, initial-scale=1.0">
                    <style>
                        @page { margin: 0.5in; size: A4; }
                        body { font-family: 'Malgun Gothic', Arial, sans-serif; margin: 0; padding: 0; background: white; -webkit-print-color-adjust: exact; }
                        @media (max-width: 768px) { 
                            table td { width: 100% !important; padding: 0 !important; text-align: left !important; }
                        }
                    </style>
                </head>
                <body>
                    ${content}
                </body>
                </html>
            `;
            
            printWindow.document.write(htmlContent);
            printWindow.document.close();
            
            printWindow.onload = function() {
                printWindow.print();
                printWindow.onafterprint = function() { 
                    printWindow.close(); 
                };
            };
        }

        // ÌéòÏù¥ÏßÄ Î°úÎìú Ïãú Ï¥àÍ∏∞Ìôî
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
